<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.7"/>
<title>NinjaFlight: Board - CJMCU</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">NinjaFlight
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.7 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('md_docs_Board_-_CJMCU.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Board - CJMCU </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>The CJMCU is a tiny (80mm) board running a STM32F103, which contains a 3-Axis Compass (HMC5883L) and an Accelerometer/Gyro (MPU6050).</p>
<p>This board does not have an onboard USB-Serial converter, so an external adapter is needed.</p>
<h1>Hardware revisions</h1>
<table class="doxtable">
<tr>
<th>Revision </th><th>Notes  </th></tr>
<tr>
<td>1 </td><td>No boot jumper pads by LED1. Uses blue and red LEDs </td></tr>
<tr>
<td>2 </td><td>Boot jumper pads presoldered with pins and a jumper by LED1. Uses green and red LEDs. </td></tr>
</table>
<p>Version 2 boards are supported from firmware v1.4.0 onwards, do NOT flash earlier versions to version 2 boards.</p>
<h1>Pins</h1>
<h2>RX Connections</h2>
<table class="doxtable">
<tr>
<th>Pin Label </th><th>Description  </th></tr>
<tr>
<td>PA0 </td><td>RC Channel 1 </td></tr>
<tr>
<td>PA1 </td><td>RC Channel 2 </td></tr>
<tr>
<td>PA2 </td><td>RC Channel 3 / USART2 TX </td></tr>
<tr>
<td>PA3 </td><td>RC Channel 4 / USART2 RX </td></tr>
<tr>
<td>VCC </td><td>Power (See note) </td></tr>
<tr>
<td>GND </td><td>Ground </td></tr>
</table>
<p>NOTE: The VCC RX Pin is not regulated and will supply what ever voltage is provided to the board, this will mean it'll provide 5v if a 5v serial connection is used. Be careful if you are using a voltage sensitive RX. A regulated 3.3v supply can be found on the top pin of column 1, just below the RX GND pin.</p>
<h2>Serial Connections</h2>
<p>USART1 (along with power) is on the following pins.</p>
<table class="doxtable">
<tr>
<th>Pin Label </th><th>Description  </th></tr>
<tr>
<td>TX1 </td><td>UART1 TX </td></tr>
<tr>
<td>RX1 </td><td>UART2 RX </td></tr>
<tr>
<td>GND </td><td>Ground </td></tr>
<tr>
<td>3V3 </td><td>Power +3.3v </td></tr>
<tr>
<td>5V </td><td>Power +5v </td></tr>
</table>
<p>USART2 is the following pins.</p>
<table class="doxtable">
<tr>
<th>Pin Label </th><th>Description  </th></tr>
<tr>
<td>PA2 </td><td>USART2 TX </td></tr>
<tr>
<td>PA3 </td><td>USART2 RX </td></tr>
</table>
<h2>Power Connections</h2>
<table class="doxtable">
<tr>
<th>Pin Label </th><th>Description  </th></tr>
<tr>
<td>Power + </td><td>Power - 1 Cell 3.7v Max </td></tr>
<tr>
<td>Power - </td><td>Ground </td></tr>
</table>
<h2>Motor Connections</h2>
<p>In standard QUADX configuration, the motors are mapped:</p>
<table class="doxtable">
<tr>
<th>Cleanflight </th><th>CJMCU  </th></tr>
<tr>
<td>Motor 1 </td><td>Motor3 </td></tr>
<tr>
<td>Motor 2 </td><td>Motor2 </td></tr>
<tr>
<td>Motor 3 </td><td>Motor4 </td></tr>
<tr>
<td>Motor 4 </td><td>Motor1 </td></tr>
</table>
<p>It is therefore simplest to wire the motors:</p><ul>
<li>Motor 1 -&gt; Clockwise</li>
<li>Motor 2 -&gt; Anti-Clockwise</li>
<li>Motor 3 -&gt; Clockwise</li>
<li>Motor 4 -&gt; Anti-Clockwise</li>
</ul>
<p>If you are using the Hubsan x4/Ladybird motors, clockwise are Blue (GND) / Red (VCC) wires, anticlockwise are Black (GND) / White (VCC). i.e. there is one wire on each motor out of the standard RED/BLACK VCC/GND polarity colors that can be used to identify polarity.</p>
<p>If you have wired as above, Motor1/Motor2 on the board will be forward.</p>
<h1>Connecting a Serial-USB Adapter</h1>
<p>You will need a USB -&gt; Serial UART adapter. Connect:</p>
<table class="doxtable">
<tr>
<th>Adapter </th><th>CJMCU  </th></tr>
<tr>
<td>Either 3.3v OR 5v </td><td>The correct 3.3v OR 5v pin </td></tr>
<tr>
<td>RX </td><td>TX </td></tr>
<tr>
<td>TX </td><td>RX </td></tr>
</table>
<p>When first connected this should power up the board, and will be in bootloader mode. If this does not happen, check the charge switch is set to POW. After the flashing process has been completed, this will allow access via the cleanflight configurator to change settings or flash a new firmware.</p>
<p>WARNING: If the motors are connected and the board boots into the bootloader, they will start to spin after around 20 seconds, it is recommended not to connect the motors until the board is flashed.</p>
<h1>Flashing</h1>
<p>To flash the board:</p><ul>
<li>Open Cleanflight Configurator</li>
<li>Choose the latest CJMCU firmware from the list.</li>
<li>Select "Load Firmware [Online]" and wait for the firmware to download.</li>
<li>Tick "No Reboot Sequence" and "Full Chip Erase"</li>
<li>Connect the USB-&gt;Serial adapter to the board</li>
<li>Select the USB-UART adapter from the top left box</li>
<li>Click "Flash Firmware"</li>
<li>You should see "Programming: SUCCESSFUL" in the log box</li>
<li>Click "Connect" -&gt; This should open the "Initial Setup" tab and you should see sensor data from the quad shown</li>
<li>Unplug the quad and short the 2 "BOOT0" pins. Revision 1 boards require this to be soldered, revision 2 boards can connect the included jumper to the two pre-soldered pins - This prevents the board from going into bootloader mode on next boot, if anything goes wrong, simply disconnect these two pins and the bootloader will start, allowing you to reflash. You cannot overwrite the bootloader.</li>
</ul>
<h1>Charging</h1>
<p>The CJMCU has on it a TP4056 Lithium battery charging IC that can charge a 1S battery at 1A using a provided 5v supply attached to the 5v serial pin.</p>
<p>To charge an attached battery:</p><ul>
<li>Set the power switch to OFF</li>
<li>Set the charge switch to CHG</li>
<li>Plug in a 1S battery to the battery pins</li>
<li>Plug in a 5v supply to the 5v serial pins</li>
</ul>
<p>The charger will finish when either the battery reaches 4.2v, or the battery's voltage is greater than the charger's input voltage.</p>
<p>The two nearby LEDs will show the status of charging:</p>
<table class="doxtable">
<tr>
<th>Status </th><th>Green LED </th><th>Red LED  </th></tr>
<tr>
<td>Charging </td><td>On </td><td>Off </td></tr>
<tr>
<td>Finished </td><td>Off </td><td>On </td></tr>
<tr>
<td>5v not connected </td><td>Off </td><td>Off </td></tr>
<tr>
<td>Batt not connected </td><td>Flashing </td><td>On </td></tr>
</table>
<h1>Helpful Hints</h1>
<ul>
<li>If you are only using a 4 channel RX, in the auxiliary configuration tab, you can add a "Horizon" mode range around 1500 for one of the the AUX channels which will result in it being always on</li>
<li>Enabling the feature MOTOR_STOP helps with crashes so it doesn't try to keep spinning on its back</li>
<li>When the power runs low, the quad will start jumping around a bit, if the flight behaviour seems strange, check your batteries charge </li>
</ul>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Mon Dec 12 2016 15:48:58 for NinjaFlight by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.7 </li>
  </ul>
</div>
</body>
</html>
