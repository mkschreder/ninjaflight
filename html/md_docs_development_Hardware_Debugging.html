<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.7"/>
<title>NinjaFlight: Hardware debugging</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">NinjaFlight
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.7 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('md_docs_development_Hardware_Debugging.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Hardware debugging </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>The code can be compiled with debugging information, you can then upload a debug version to a board via a JLink/St-Link debug adapter and step through the code in your IDE.</p>
<p>More information about the necessary hardware and setting up the eclipse IDE can be found Hardware Debugging in Eclipse.md "here"</p>
<p>A guide for visual studio can be found here: <a href="http://visualgdb.com/tutorials/arm/st-link/">http://visualgdb.com/tutorials/arm/st-link/</a></p>
<p>This video is also helpful in understanding the proces: <a href="https://www.youtube.com/watch?v=kjvqySyNw20">https://www.youtube.com/watch?v=kjvqySyNw20</a></p>
<h2>Hardware</h2>
<p>Various debugging hardware solutions exist, the Segger J-Link clones are cheap and are known to work on Windows with both the Naze and Olimexino platforms.</p>
<h3>J-Link devices</h3>
<p>Segger make excellent debuggers and debug software.</p>
<p>The Segger J-Link GDB server can be obtained from here.</p>
<p><a href="http://www.segger.com/jlink-software.html">http://www.segger.com/jlink-software.html</a></p>
<h4>Segger J-Link EDU EDU version, for hobbyists and educational use.</h4>
<div class="image">
<img src="assets/hardware/j-link-edu.jpg"  alt="Segger J-Link EDU"/>
</div>
<p><a href="https://www.segger.com/j-link-edu.html">https://www.segger.com/j-link-edu.html</a></p>
<h4>USB-MiniJTAG J-Link JTAG/SWD Debugger/Emulator</h4>
<p><a href="http://www.hotmcu.com/usbminijtag-jlink-jtagswd-debuggeremula%E2%80%8Btor-p-29.html?cPath=3_25&zenid=fdefvpnod186umrhsek225dc10">http://www.hotmcu.com/usbminijtag-jlink-jtagswd-debuggeremula%E2%80%8Btor-p-29.html?cPath=3_25&amp;zenid=fdefvpnod186umrhsek225dc10</a></p>
<div class="image">
<img src="assets/hardware/THAOYU-USB-MiniJTAG.jpg"  alt="THAOYU USB-MiniJTAG"/>
</div>
<h5>ARM-JTAG-20-10 adapter</h5>
<p><a href="https://www.olimex.com/Products/ARM/JTAG/ARM-JTAG-20-10/">https://www.olimex.com/Products/ARM/JTAG/ARM-JTAG-20-10/</a> <a href="http://uk.farnell.com/jsp/search/productdetail.jsp?sku=2144328">http://uk.farnell.com/jsp/search/productdetail.jsp?sku=2144328</a></p>
<div class="image">
<img src="assets/hardware/OLIMEX-ARM-JTAG-ADAPTER-2144328-40.jpg"  alt="OLIMEX ARM JTAG ADAPTER"/>
</div>
<h4>CJMCU-STM32 Singlechip Development Board Jlink Downloader Jlink ARM Programmer</h4>
<div class="image">
<img src="assets/hardware/cjmcu-jlink-front.jpg"  alt="CJMCU-STM32 Jlink ARM Programmer Front"/>
</div>
<div class="image">
<img src="assets/hardware/cjmcu-jlink-back.jpg"  alt="CJMCU-STM32 Jlink ARM Programmer Back"/>
</div>
<p><a href="http://www.goodluckbuy.com/cjmcu-stm32-singlechip-development-board-jlink-downloader-jlink-arm-programmer.html">http://www.goodluckbuy.com/cjmcu-stm32-singlechip-development-board-jlink-downloader-jlink-arm-programmer.html</a></p>
<h3>STLink V2 devices</h3>
<p>STLink V2 devices can be used too, via OpenOCD.</p>
<h4>CEPark STLink V2</h4>
<div class="image">
<img src="assets/hardware/cepark-stlink-v2-front.jpg"  alt="CEPark STLink V2"/>
</div>
<p><a href="http://www.goodluckbuy.com/cepark-stlink-st-link-v2-emulator-programmer-stm8-stm32-downloader.html">http://www.goodluckbuy.com/cepark-stlink-st-link-v2-emulator-programmer-stm8-stm32-downloader.html</a></p>
<h2>Compilation options</h2>
<p>use <code>DEBUG=GDB</code> make argument.</p>
<p>You may find that if you compile all the files with debug information on that the program is too big to fit on the target device. If this happens you have some options:</p>
<ul>
<li>Compile all files without debug information (<code>make clean</code>, <code>make ...</code>), then re-save or <code>touch</code> the files you want to be able to step though and then run <code>make DEBUG=GDB</code>. This will then re-compile the files you're interested in debugging with debugging symbols and you will get a smaller binary file which should then fit on the device.</li>
<li>You could use a development board such as an Olimexino or an EUSTM32F103RB, development boards often have more flash rom.</li>
</ul>
<h2>OSX</h2>
<h3>Install OpenOCD via Brew</h3>
<p>ruby -e "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)"</p>
<p>brew install openocd</p>
<h3>GDB debug server</h3>
<h4>J-Link</h4>
<h5>Windows</h5>
<p>Run the Launch the J-Link GDB Server program and configure using UI.</p>
<h4>OpenOCD</h4>
<h5>Windows</h5>
<p>STM32F103 targets </p><pre class="fragment">"C:\Program Files (x86)\UTILS\openocd-0.8.0\bin-x64\openocd-x64-0.8.0.exe" -f interface/stlink-v2.cfg -f target/stm32f1x_stlink.cfg
</pre><p>STM32F30x targets </p><pre class="fragment">"C:\Program Files (x86)\UTILS\openocd-0.8.0\bin-x64\openocd-x64-0.8.0.exe" -f scripts\board\stm32f3discovery.cfg
</pre><h5>OSX/Linux</h5>
<p>STM32F30x targets </p><pre class="fragment">  openocd -f /usr/share/openocd/scripts/board/stm32vldiscovery.cfg</pre> </div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Mon Dec 12 2016 15:48:58 for NinjaFlight by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.7 </li>
  </ul>
</div>
</body>
</html>
